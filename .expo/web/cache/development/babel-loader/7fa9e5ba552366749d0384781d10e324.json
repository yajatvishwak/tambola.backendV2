{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/media/yajat-vishwakk/MainHDD/Coding/Projects/TambolaV2/frontend/Tambola/app/Game/Game.js\";\nimport React, { Component, useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport env from \"../../variable\";\nimport makeaCall from \"../../utility/networkCall\";\nimport * as Speech from \"expo-speech\";\nimport { AdMobBanner } from \"expo-ads-admob\";\nimport Previous from \"./components/Previous\";\nimport Calling from \"./components/Calling\";\nimport Bar from \"./components/Bar\";\nimport Ticket from \"./components/Ticket\";\nimport Claim from \"./components/Claim\";\nimport Board from \"./components/Board\";\nimport Global from \"../../utility/Global\";\nimport { useNavigation } from \"@react-navigation/native\";\n\nvar data = require(\"../TTS/tts.json\");\n\nvar io = require(\"socket.io-client\");\n\nfunction Game(props) {\n  var roomID = Global.roomID;\n  var username = Global.username;\n  var navigation = useNavigation();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      claimModal = _useState2[0],\n      setclaimModal = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      boardModal = _useState4[0],\n      setboardModal = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mark = _useState6[0],\n      setMark = _useState6[1];\n\n  var _useState7 = useState({}),\n      _useState8 = _slicedToArray(_useState7, 2),\n      calling = _useState8[0],\n      setcalling = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      disconnect = _useState10[0],\n      setdisconnect = _useState10[1];\n\n  var _useState11 = useState({}),\n      _useState12 = _slicedToArray(_useState11, 2),\n      winner = _useState12[0],\n      setwinner = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      gameOver = _useState14[0],\n      setgameOver = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      category = _useState16[0],\n      setcategory = _useState16[1];\n\n  var _useState17 = useState([[0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]]),\n      _useState18 = _slicedToArray(_useState17, 2),\n      ticket = _useState18[0],\n      setticket = _useState18[1];\n\n  useEffect(function () {\n    var socket = io(env.apiUrl);\n\n    function connectSocket(username, room) {\n      socket.on(\"connect\", function () {\n        console.log(\"Connected to the WS server\");\n        socket.emit(\"room\", {\n          username: username,\n          room: room\n        });\n      });\n    }\n\n    makeaCall(\"POST\", env.apiUrl + \"/game/getCategoryandTicket\", {\n      roomID: roomID,\n      username: username\n    }).then(function (res) {\n      if (res == null) {\n        alert(\"There's some network issue. Please check your network or contact the admin. Error code: NE-catTic\");\n      } else {\n        setcategory(res.category);\n        setticket(res.ticket);\n      }\n    });\n    connectSocket(username, roomID);\n    socket.on(\"winner\", function (m) {\n      var message = m.message;\n      var type = m.type;\n      setwinner(m.winnerobj[0]);\n\n      if (type === \"FH\") {\n        setgameOver(true);\n      } else {\n        alert(message);\n      }\n    });\n    socket.on(\"broadcast\", function (m) {\n      handleCallingNumber(m);\n      var go = m.gameOver;\n      setgameOver(go);\n    });\n    socket.on(\"kickUser\", function () {\n      alert(\"You have been disconnected by Admin\");\n      setdisconnect(true);\n    });\n  }, []);\n\n  var callOut = function callOut(number) {\n    var array = data[number];\n    var element = array[Math.floor(Math.random() * array.length)] || array[0];\n    var speech = element + \"    the number    \" + number;\n    Speech.speak(speech);\n  };\n\n  var handleClaimModal = function handleClaimModal() {\n    setclaimModal(!claimModal);\n  };\n\n  var handleBoardModal = function handleBoardModal() {\n    setboardModal(!boardModal);\n  };\n\n  var handleCallingNumber = function handleCallingNumber(m) {\n    setcalling(m);\n\n    if (m.number) {\n      callOut(m.number);\n    }\n  };\n\n  var handleWinners = function handleWinners(winner) {\n    setwinner(winner);\n  };\n\n  var updateMarked = function updateMarked(data) {\n    setMark(data);\n  };\n\n  var generateTicket = function generateTicket() {\n    if (ticket.length == 0) {\n      return [[0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]];\n    } else {\n      var arr = [[0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]];\n\n      for (var i = 0; i < 3; i++) {\n        for (var j = 0; j < 9; j++) {\n          if (mark.indexOf(ticket[i][j]) > -1 && mark[mark.indexOf(ticket[i][j])] === ticket[i][j]) {\n            arr[i][j] = ticket[i][j];\n          } else if (mark.indexOf(ticket[i][j]) === -1 && ticket[i][j] !== 0) {\n            arr[i][j] = -1;\n          } else {\n            continue;\n          }\n        }\n      }\n\n      return arr;\n    }\n  };\n\n  if (disconnect) {\n    alert(\"You have been disconnected by admin. If you think this was a mistake, contact your admin.\");\n    return null;\n  } else if (gameOver === true) {\n    alert(\"Game Over\");\n    navigation.replace(\"Winners\");\n    return null;\n  } else {\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 7\n      }\n    }, React.createElement(Modal, {\n      animationType: \"fade\",\n      transparent: false,\n      visible: claimModal,\n      onRequestClose: function onRequestClose() {\n        setclaimModal(false);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }\n    }, React.createElement(Claim, {\n      category: category,\n      ticket: generateTicket(),\n      updateWinner: handleWinners,\n      close: handleClaimModal,\n      username: username,\n      roomID: roomID,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }\n    })), React.createElement(Modal, {\n      animationType: \"fade\",\n      transparent: false,\n      visible: boardModal,\n      onRequestClose: function onRequestClose() {\n        setboardModal(false);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }\n    }, React.createElement(Board, {\n      done: calling.done || null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }\n    })), React.createElement(View, {\n      style: styles.prevContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }\n    }, React.createElement(Previous, {\n      arr: calling.done || [0, 0, 0, 0, 0],\n      style: styles.previous,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }\n    })), React.createElement(View, {\n      style: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }\n    }, React.createElement(StatusBar, {\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 11\n      }\n    }), React.createElement(View, {\n      style: styles.adView,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }\n    }, React.createElement(AdMobBanner, {\n      bannerSize: \"fullBanner\",\n      adUnitID: \"ca-app-pub-7508456089542607/9966195872\",\n      servePersonalizedAds: true,\n      onDidFailToReceiveAdWithError: function onDidFailToReceiveAdWithError(bannerError) {\n        return console.log(bannerError);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }\n    })), React.createElement(Calling, {\n      number: calling.number || 0,\n      style: styles.calling,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 11\n      }\n    }), React.createElement(Ticket, {\n      style: styles.rect,\n      ticket: ticket,\n      updateMark: updateMarked,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }\n    }), React.createElement(View, {\n      style: styles.buttonContainer2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }\n    }, React.createElement(Bar, {\n      clickClaimModal: handleClaimModal,\n      clickBoardModal: handleBoardModal,\n      clickRulesModal: function clickRulesModal() {\n        alert(\"Coming soon\");\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 13\n      }\n    }))));\n  }\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 5,\n    backgroundColor: \"rgba(227,214,214,1)\"\n  },\n  adView: {\n    alignSelf: \"center\"\n  },\n  button: {\n    width: 120,\n    height: 48,\n    backgroundColor: \"rgba(242,163,101,1)\",\n    borderRadius: 12,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  buttonContainer: {\n    flexDirection: \"row\",\n    marginTop: 10,\n    justifyContent: \"space-evenly\"\n  },\n  buttonContainer2: {\n    flex: 1,\n    justifyContent: \"flex-end\",\n    marginBottom: 15\n  },\n  rect: {\n    width: 400,\n    height: 200,\n    backgroundColor: \"rgba(255,255,255,1)\",\n    borderRadius: 10,\n    alignSelf: \"center\",\n    marginTop: 30\n  },\n  previous: {\n    height: 80,\n    width: \"100%\",\n    marginTop: 10\n  },\n  prevContainer: {\n    alignSelf: \"center\",\n    flex: 1\n  },\n  calling: {\n    height: 170,\n    width: 170,\n    marginTop: 30,\n    alignSelf: \"center\"\n  },\n  callingContainer: {\n    justifyContent: \"center\",\n    alignContent: \"center\",\n    margin: 30\n  }\n});\nexport default Game;","map":{"version":3,"sources":["/media/yajat-vishwakk/MainHDD/Coding/Projects/TambolaV2/frontend/Tambola/app/Game/Game.js"],"names":["React","Component","useState","useEffect","env","makeaCall","Speech","AdMobBanner","Previous","Calling","Bar","Ticket","Claim","Board","Global","useNavigation","data","require","io","Game","props","roomID","username","navigation","claimModal","setclaimModal","boardModal","setboardModal","mark","setMark","calling","setcalling","disconnect","setdisconnect","winner","setwinner","gameOver","setgameOver","category","setcategory","ticket","setticket","socket","apiUrl","connectSocket","room","on","console","log","emit","then","res","alert","m","message","type","winnerobj","handleCallingNumber","go","callOut","number","array","element","Math","floor","random","length","speech","speak","handleClaimModal","handleBoardModal","handleWinners","updateMarked","generateTicket","arr","i","j","indexOf","replace","done","styles","prevContainer","previous","container","adView","bannerError","rect","buttonContainer2","StyleSheet","create","flex","backgroundColor","alignSelf","button","width","height","borderRadius","justifyContent","alignItems","buttonContainer","flexDirection","marginTop","marginBottom","callingContainer","alignContent","margin"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\nimport { StyleSheet, View, StatusBar, Text, Modal, Alert } from \"react-native\";\n\nimport env from \"../../variable\";\nimport makeaCall from \"../../utility/networkCall\";\nimport * as Speech from \"expo-speech\";\n\nimport { AdMobBanner } from \"expo-ads-admob\";\n\nimport Previous from \"./components/Previous\";\nimport Calling from \"./components/Calling\";\nimport Bar from \"./components/Bar\";\nimport Ticket from \"./components/Ticket\";\nimport Claim from \"./components/Claim\";\nimport Board from \"./components/Board\";\nimport Global from \"../../utility/Global\";\nimport { useNavigation } from \"@react-navigation/native\";\n\nconst data = require(\"../TTS/tts.json\");\n\nconst io = require(\"socket.io-client\");\n\n// ongameover put playnow to false\n\n//connectSocket(username, roomID);\n\nfunction Game(props) {\n  var roomID = Global.roomID;\n  var username = Global.username;\n  const navigation = useNavigation();\n  const [claimModal, setclaimModal] = useState(false);\n  const [boardModal, setboardModal] = useState(false);\n  const [mark, setMark] = useState([]);\n  const [calling, setcalling] = useState({});\n  const [disconnect, setdisconnect] = useState(false);\n  const [winner, setwinner] = useState({});\n  const [gameOver, setgameOver] = useState(false);\n  const [category, setcategory] = useState([]);\n  const [ticket, setticket] = useState([\n    [0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0],\n  ]);\n  //console.log(\"THEROOM:\" + roomID);\n  //console.log(username);\n\n  useEffect(() => {\n    // Pregame functions\n    const socket = io(env.apiUrl);\n    function connectSocket(username, room) {\n      socket.on(\"connect\", function () {\n        console.log(\"Connected to the WS server\");\n        socket.emit(\"room\", { username: username, room: room });\n      });\n    }\n    makeaCall(\"POST\", env.apiUrl + \"/game/getCategoryandTicket\", {\n      roomID: roomID,\n      username: username,\n    }).then((res) => {\n      //console.log(\"This is null wtf> \" + res);\n      if (res == null) {\n        alert(\n          \"There's some network issue. Please check your network or contact the admin. Error code: NE-catTic\"\n        );\n      } else {\n        //category = res.category;\n        setcategory(res.category);\n        //ticket = res.ticket;\n        setticket(res.ticket);\n      }\n    });\n    connectSocket(username, roomID);\n    socket.on(\"winner\", (m) => {\n      //console.log(m);\n      var message = m.message;\n      var type = m.type;\n      setwinner(m.winnerobj[0]);\n      if (type === \"FH\") {\n        setgameOver(true);\n      } else {\n        alert(message);\n      }\n\n      //console.log(m);\n    });\n\n    socket.on(\"broadcast\", (m) => {\n      handleCallingNumber(m);\n      var go = m.gameOver;\n      setgameOver(go);\n    });\n    socket.on(\"kickUser\", () => {\n      alert(\"You have been disconnected by Admin\");\n      setdisconnect(true);\n    });\n  }, []);\n\n  //TTS\n  const callOut = (number) => {\n    var array = data[number];\n    const element = array[Math.floor(Math.random() * array.length)] || array[0];\n    var speech = element + \"    the number    \" + number;\n    Speech.speak(speech);\n  };\n\n  // handling state function\n  const handleClaimModal = () => {\n    setclaimModal(!claimModal);\n  };\n  const handleBoardModal = () => {\n    setboardModal(!boardModal);\n  };\n  const handleCallingNumber = (m) => {\n    //console.log(m);\n\n    setcalling(m);\n    if (m.number) {\n      callOut(m.number);\n    }\n  };\n  const handleWinners = (winner) => {\n    setwinner(winner);\n  };\n  const updateMarked = (data) => {\n    setMark(data);\n    //console.log(mark);\n  };\n  // console.log(category);\n  // console.log(ticket);\n  const generateTicket = () => {\n    //console.log(ticket);\n    if (ticket.length == 0) {\n      return [\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n      ];\n    } else {\n      var arr = [\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0],\n      ];\n      for (var i = 0; i < 3; i++) {\n        for (var j = 0; j < 9; j++) {\n          if (\n            mark.indexOf(ticket[i][j]) > -1 &&\n            mark[mark.indexOf(ticket[i][j])] === ticket[i][j]\n          ) {\n            arr[i][j] = ticket[i][j];\n          } else if (mark.indexOf(ticket[i][j]) === -1 && ticket[i][j] !== 0) {\n            arr[i][j] = -1;\n          } else {\n            continue;\n          }\n        }\n      }\n      //console.log(arr);\n      return arr;\n    }\n    // the ticket in 3x9 format is stored in arr\n  };\n\n  if (disconnect) {\n    alert(\n      \"You have been disconnected by admin. If you think this was a mistake, contact your admin.\"\n    );\n    return null;\n  } else if (gameOver === true) {\n    alert(\"Game Over\");\n\n    //redirect to winner page instead\n    navigation.replace(\"Winners\");\n    return null;\n  } else {\n    return (\n      <React.Fragment>\n        <Modal\n          animationType=\"fade\"\n          transparent={false}\n          visible={claimModal}\n          onRequestClose={() => {\n            setclaimModal(false);\n          }}\n        >\n          <Claim\n            category={category}\n            ticket={generateTicket()}\n            updateWinner={handleWinners}\n            close={handleClaimModal}\n            username={username}\n            roomID={roomID}\n          />\n        </Modal>\n        <Modal\n          animationType=\"fade\"\n          transparent={false}\n          visible={boardModal}\n          onRequestClose={() => {\n            setboardModal(false);\n          }}\n        >\n          <Board done={calling.done || null} />\n        </Modal>\n\n        <View style={styles.prevContainer}>\n          <Previous\n            arr={calling.done || [0, 0, 0, 0, 0]}\n            style={styles.previous}\n          ></Previous>\n        </View>\n        <View style={styles.container}>\n          <StatusBar hidden />\n          <View style={styles.adView}>\n            <AdMobBanner\n              bannerSize=\"fullBanner\"\n              adUnitID=\"ca-app-pub-7508456089542607/9966195872\"\n              servePersonalizedAds\n              onDidFailToReceiveAdWithError={(bannerError) =>\n                console.log(bannerError)\n              }\n            />\n          </View>\n\n          <Calling\n            number={calling.number || 0}\n            style={styles.calling}\n          ></Calling>\n          <Ticket\n            style={styles.rect}\n            ticket={ticket}\n            updateMark={updateMarked}\n          />\n          <View style={styles.buttonContainer2}>\n            <Bar\n              clickClaimModal={handleClaimModal}\n              clickBoardModal={handleBoardModal}\n              clickRulesModal={() => {\n                alert(\"Coming soon\");\n              }}\n            />\n          </View>\n        </View>\n      </React.Fragment>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 5,\n    backgroundColor: \"rgba(227,214,214,1)\",\n  },\n  adView: { alignSelf: \"center\" },\n  button: {\n    width: 120,\n    height: 48,\n    backgroundColor: \"rgba(242,163,101,1)\",\n    borderRadius: 12,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  buttonContainer: {\n    flexDirection: \"row\",\n    marginTop: 10,\n    justifyContent: \"space-evenly\",\n  },\n  buttonContainer2: {\n    flex: 1,\n    justifyContent: \"flex-end\",\n    marginBottom: 15,\n  },\n\n  rect: {\n    width: 400,\n    height: 200,\n    backgroundColor: \"rgba(255,255,255,1)\",\n    borderRadius: 10,\n    alignSelf: \"center\",\n    marginTop: 30,\n  },\n  previous: {\n    height: 80,\n    width: \"100%\",\n    marginTop: 10,\n  },\n  prevContainer: {\n    alignSelf: \"center\",\n    flex: 1,\n  },\n  calling: {\n    height: 170,\n    width: 170,\n    marginTop: 30,\n    alignSelf: \"center\",\n  },\n  callingContainer: {\n    justifyContent: \"center\",\n    alignContent: \"center\",\n    margin: 30,\n  },\n});\n\nexport default Game;\n"]},"metadata":{},"sourceType":"module"}